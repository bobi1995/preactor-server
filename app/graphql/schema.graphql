## GraphQL Schema (Complete)

scalar DateTime # Assuming you have a DateTime scalar for ISO date strings
type Query {
  hello: String

  # Resource Queries
  """
  Fetches all resources.
  """
  getResources: [Resource!]!
  """
  Fetches a single resource by its ID.
  """
  getResource(id: Int!): Resource

  # ResourceGroup Queries
  # getResourceGroups: [ResourceGroup]
  # getResourceGroup(id: ID!): ResourceGroup

  # Shift Queries
  getShifts: [Shift]
  getShift(id: ID!): Shift

  # Break Queries
  getBreaks: [Break] # Assuming you want to query all available breaks
  # WeekSchedule Queries
  getSchedules: [Schedule]
  getSchedule(id: ID!): Schedule

  # Orders Queries
  getOrders: [Orders]

  # AlternativeShift Queries (Example - if needed)
  # getAlternativeShiftsForResource(resourceId: ID!): [AlternativeShift]
}

type Mutation {
  # --- Resource Mutations ---
  """
  Creates a new resource.
  """
  createResource(input: CreateResourceInput!): Resource!
  """
  Updates an existing resource by its ID.
  """
  updateResource(input: UpdateResourceInput!): Resource!
  """
  Deletes a resource by its ID.
  """
  deleteResource(id: Int!): SuccessMessage

  assignScheduleToResource(resourceId: ID!, scheduleId: ID!): Resource # Updates Resource.weekScheduleId
  assignAlternativeShiftToResource(
    input: AssignAlternativeShiftInput!
  ): AlternativeShifts
  # ResourceGroup Mutations
  createResourceGroup(input: ResourceGroupInput!): ResourceGroup
  updateResourceGroup(id: ID!, input: UpdateResourceGroupInput!): ResourceGroup
  deleteResourceGroup(id: ID!): SuccessMessage # Or return ResourceGroup
  addResourceToGroup(resourceId: ID!, resourceGroupId: ID!): ResourceGroup
  removeResourceFromGroup(resourceId: ID!, resourceGroupId: ID!): SuccessMessage # Deletes link from REL_Resource_Group
  # Shift Mutations
  createShift(input: ShiftFields!): Shift
  updateShift(id: ID!, input: ShiftFields!): Shift # Added update mutation
  deleteShift(id: ID!): SuccessMessage # Or return Shift
  # Break Mutations
  createBreak(input: BreakFields!): Break
  updateBreak(id: ID!, input: BreakFields!): Break # Added update mutation
  deleteBreak(id: ID!): SuccessMessage # Or return Break
  assignBreakToShift(shiftId: ID!, breakId: ID!): Shift # Manages REL_Break_Shift or implicit M2M
  removeBreakFromShift(shiftId: ID!, breakId: ID!): Shift # Manages REL_Break_Shift or implicit M2M
  # WeekSchedule Mutations
  createSchedule(input: CreateWeekScheduleInput!): Schedule
  updateSchedule(id: ID!, input: UpdateWeekScheduleInput!): Schedule
  deleteSchedule(id: ID!): SuccessMessage # Or return WeekSchedule
  updateAlternativeShift(
    id: ID!
    input: UpdateAlternativeShiftInput!
  ): AlternativeShifts # Added update
  deleteAlternativeShift(id: ID!): SuccessMessage # Or return AlternativeShift
  assignMassiveAlternativeShiftToResources(
    input: AssignMassiveAlternativeShiftInput!
  ): [AlternativeShifts]
}

# --- Main Data Types ---

type Resource {
  id: Int!
  name: String!
  description: String
  picture: String
  color: String
  """
  External identifier for linking with other systems.
  """
  externalCode: String
  """
  Whether the resource is accumulative (e.g., a buffer).
  """
  accumulative: Boolean

  # --- Relational Fields ---
  """
  The weekly schedule assigned to this resource.
  """
  schedule: Schedule
  """
  Alternative shifts that override the regular schedule.
  """
  alternativeShifts: [AlternativeShifts!]!
  """
  Orders assigned to this resource.
  """
  orders: [Orders!]!
}

type ResourceGroup {
  id: ID!
  name: String!
  description: String
  resources: [Resource] # Resources belonging to this group
}

type Shift {
  id: ID!
  name: String!
  startHour: String!
  endHour: String!
  breaks: [Break!]!
}

type Break {
  id: ID!
  name: String!
  startTime: String!
  endTime: String!
  shifts: [Shift!]!
}

type Schedule { #
  id: ID!
  name: String
  monday: Shift
  tuesday: Shift
  wednesday: Shift
  thursday: Shift
  friday: Shift
  saturday: Shift
  sunday: Shift
  resources: [Resource]
}

type AlternativeShifts { # Renamed from AlternativeShift to AlternativeShifts
  id: ID!
  shift: Shift! # Assuming a shift is mandatory for an alternative shift record
  resource: Resource!
  startDate: DateTime! # Assuming DateTime scalar
  endDate: DateTime! # Assuming DateTime scalar
  #status: ENUM ("maintenance", "breakdown", "active") # Example status enum
}

type Orders {
  id: ID!
  OrderNo: String
  OpNo: String
  ResourceExternalCode: String
  # resource: Resource # Could resolve Resource object from ResourceExternalCode
  StartTime: DateTime # Prisma DateTime?
  EndTime: DateTime # Prisma DateTime?
  Project: String
  Duration: Int # Prisma Int?
  Start_min: Int # Prisma Int?
  End_min: Int # Prisma Int?
  TaskIndex: String
  PartNo: String
  Product: String
  OpName: String
  ResourceGroup: String # This is a string field in Orders, distinct from the ResourceGroup model
  RemainingQuantity: Float # Prisma Float?
  SetupTime: Int # Prisma Int?
}

# --- Utility Types ---
type SuccessMessage {
  success: Boolean!
  message: String
}

# --- Input Types ---

"""
Input for creating a new Resource.
"""
input CreateResourceInput {
  name: String!
  description: String
  picture: String
  color: String
  externalCode: String
  accumulative: Boolean
  scheduleId: Int
  changeover_group_id: Int
}

"""
Input for updating an existing Resource.
"""
input UpdateResourceInput {
  id: Int!
  name: String
  description: String
  picture: String
  color: String
  externalCode: String
  accumulative: Boolean
  scheduleId: Int
  changeover_group_id: Int
}

input ResourceGroupInput {
  name: String!
  description: String
}

input UpdateResourceGroupInput {
  name: String
  description: String
}

input ShiftFields { # For create
  name: String
  startHour: String # e.g., "08:00"
  endHour: String # e.g., "17:00"
}

input BreakFields { # For create
  name: String
  startTime: String
  endTime: String
}

input CreateWeekScheduleInput {
  name: String!
  mondayId: ID
  tuesdayId: ID
  wednesdayId: ID
  thursdayId: ID
  fridayId: ID
  saturdayId: ID
  sundayId: ID
}

input UpdateWeekScheduleInput {
  name: String
  mondayId: ID
  tuesdayId: ID
  wednesdayId: ID
  thursdayId: ID
  fridayId: ID
  saturdayId: ID
  sundayId: ID
}

input AssignAlternativeShiftInput {
  resourceId: ID!
  shiftId: ID!
  startDate: DateTime!
  endDate: DateTime!
}

input UpdateAlternativeShiftInput {
  shiftId: ID
  startDate: DateTime
  endDate: DateTime
}

input AssignMassiveAlternativeShiftInput {
  resourceIds: [ID!]!
  shiftId: ID!
  startDate: DateTime!
  endDate: DateTime!
}
